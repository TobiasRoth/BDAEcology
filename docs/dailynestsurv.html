<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>24 Daily nest survival | Bayesian Data Analysis in Ecology with R and Stan</title>
  <meta name="description" content="This GitHub-book is a collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="24 Daily nest survival | Bayesian Data Analysis in Ecology with R and Stan" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.jpg" />
  <meta property="og:description" content="This GitHub-book is a collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="github-repo" content="TobiasRoth/BDAEcology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="24 Daily nest survival | Bayesian Data Analysis in Ecology with R and Stan" />
  
  <meta name="twitter:description" content="This GitHub-book is a collection of updates and additional material to the book Bayesian Data Analysis in Ecology Using Linear Models with R, BUGS, and STAN." />
  <meta name="twitter:image" content="/images/cover.jpg" />

<meta name="author" content="Fränzi Korner-Nievergelt, Tobias Roth, Stefanie von Felten, Jerôme Guélat, Bettina Almasi, Louis Hunninck, Pius Korner-Nievergelt" />


<meta name="date" content="2025-10-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="zeroinflated-poisson-lmm.html"/>
<link rel="next" href="cjs_with_mix.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="settings/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I BASIC STATISTICS FOR ECOLOGISTS</b></span></li>
<li class="chapter" data-level="1" data-path="PART-I.html"><a href="PART-I.html"><i class="fa fa-check"></i><b>1</b> Introduction to PART I</a>
<ul>
<li class="chapter" data-level="1.1" data-path="PART-I.html"><a href="PART-I.html#further-reading"><i class="fa fa-check"></i><b>1.1</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics of statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#variables-and-observations"><i class="fa fa-check"></i><b>2.1</b> Variables and observations</a></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#displaying-and-summarizing-data"><i class="fa fa-check"></i><b>2.2</b> Displaying and summarizing data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="basics.html"><a href="basics.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="basics.html"><a href="basics.html#location-and-scatter"><i class="fa fa-check"></i><b>2.2.2</b> Location and scatter</a></li>
<li class="chapter" data-level="2.2.3" data-path="basics.html"><a href="basics.html#correlations"><i class="fa fa-check"></i><b>2.2.3</b> Correlations</a></li>
<li class="chapter" data-level="2.2.4" data-path="basics.html"><a href="basics.html#principal-components-analyses-pca"><i class="fa fa-check"></i><b>2.2.4</b> Principal components analyses PCA</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basics.html"><a href="basics.html#inferential-statistics"><i class="fa fa-check"></i><b>2.3</b> Inferential statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="basics.html"><a href="basics.html#uncertainty"><i class="fa fa-check"></i><b>2.3.1</b> Uncertainty</a></li>
<li class="chapter" data-level="2.3.2" data-path="basics.html"><a href="basics.html#standard-error"><i class="fa fa-check"></i><b>2.3.2</b> Standard error</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basics.html"><a href="basics.html#bayes-theorem-and-the-common-aim-of-frequentist-and-bayesian-methods"><i class="fa fa-check"></i><b>2.4</b> Bayes theorem and the common aim of frequentist and Bayesian methods</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="basics.html"><a href="basics.html#bayes-theorem-for-discrete-events"><i class="fa fa-check"></i><b>2.4.1</b> Bayes theorem for discrete events</a></li>
<li class="chapter" data-level="2.4.2" data-path="basics.html"><a href="basics.html#bayes-theorem-for-continuous-parameters"><i class="fa fa-check"></i><b>2.4.2</b> Bayes theorem for continuous parameters</a></li>
<li class="chapter" data-level="2.4.3" data-path="basics.html"><a href="basics.html#estimating-a-mean-assuming-that-the-variance-is-known"><i class="fa fa-check"></i><b>2.4.3</b> Estimating a mean assuming that the variance is known</a></li>
<li class="chapter" data-level="2.4.4" data-path="basics.html"><a href="basics.html#estimating-the-mean-and-the-variance"><i class="fa fa-check"></i><b>2.4.4</b> Estimating the mean and the variance</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="basics.html"><a href="basics.html#classical-frequentist-tests-and-alternatives"><i class="fa fa-check"></i><b>2.5</b> Classical frequentist tests and alternatives</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="basics.html"><a href="basics.html#nullhypothesis-testing"><i class="fa fa-check"></i><b>2.5.1</b> Nullhypothesis testing</a></li>
<li class="chapter" data-level="2.5.2" data-path="basics.html"><a href="basics.html#comparison-of-a-sample-with-a-fixed-value-one-sample-t-test"><i class="fa fa-check"></i><b>2.5.2</b> Comparison of a sample with a fixed value (one-sample t-test)</a></li>
<li class="chapter" data-level="2.5.3" data-path="basics.html"><a href="basics.html#comparison-of-the-locations-between-two-groups-two-sample-t-test"><i class="fa fa-check"></i><b>2.5.3</b> Comparison of the locations between two groups (two-sample t-test)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="basics.html"><a href="basics.html#whyBayes"><i class="fa fa-check"></i><b>2.6</b> Comparing frequentist and Bayesian approach - an why we use Bayes</a></li>
<li class="chapter" data-level="2.7" data-path="basics.html"><a href="basics.html#summary"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analyses_steps.html"><a href="analyses_steps.html"><i class="fa fa-check"></i><b>3</b> Data analysis step by step</a>
<ul>
<li class="chapter" data-level="3.1" data-path="analyses_steps.html"><a href="analyses_steps.html#step1"><i class="fa fa-check"></i><b>3.1</b> Plausibility of data</a></li>
<li class="chapter" data-level="3.2" data-path="analyses_steps.html"><a href="analyses_steps.html#step2"><i class="fa fa-check"></i><b>3.2</b> Relationships</a></li>
<li class="chapter" data-level="3.3" data-path="analyses_steps.html"><a href="analyses_steps.html#step3"><i class="fa fa-check"></i><b>3.3</b> Data distribution</a></li>
<li class="chapter" data-level="3.4" data-path="analyses_steps.html"><a href="analyses_steps.html#step4"><i class="fa fa-check"></i><b>3.4</b> Preparation of explanatory variables</a></li>
<li class="chapter" data-level="3.5" data-path="analyses_steps.html"><a href="analyses_steps.html#step5"><i class="fa fa-check"></i><b>3.5</b> Data structure</a></li>
<li class="chapter" data-level="3.6" data-path="analyses_steps.html"><a href="analyses_steps.html#step6"><i class="fa fa-check"></i><b>3.6</b> Define prior distributions</a></li>
<li class="chapter" data-level="3.7" data-path="analyses_steps.html"><a href="analyses_steps.html#step7"><i class="fa fa-check"></i><b>3.7</b> Fit the model</a></li>
<li class="chapter" data-level="3.8" data-path="analyses_steps.html"><a href="analyses_steps.html#step8"><i class="fa fa-check"></i><b>3.8</b> Check model</a></li>
<li class="chapter" data-level="3.9" data-path="analyses_steps.html"><a href="analyses_steps.html#step9"><i class="fa fa-check"></i><b>3.9</b> Model uncertainty</a></li>
<li class="chapter" data-level="3.10" data-path="analyses_steps.html"><a href="analyses_steps.html#step10"><i class="fa fa-check"></i><b>3.10</b> Present model results</a></li>
<li class="chapter" data-level="" data-path="analyses_steps.html"><a href="analyses_steps.html#further-reading-1"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>4</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="distributions.html"><a href="distributions.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="distributions.html"><a href="distributions.html#discrete-distributions"><i class="fa fa-check"></i><b>4.2</b> Discrete distributions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="distributions.html"><a href="distributions.html#bernoulli-dist"><i class="fa fa-check"></i><b>4.2.1</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="distributions.html"><a href="distributions.html#binomial-dist"><i class="fa fa-check"></i><b>4.2.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="4.2.3" data-path="distributions.html"><a href="distributions.html#poisson"><i class="fa fa-check"></i><b>4.2.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="4.2.4" data-path="distributions.html"><a href="distributions.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>4.2.4</b> Negative-binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="distributions.html"><a href="distributions.html#continuous-distributions"><i class="fa fa-check"></i><b>4.3</b> Continuous distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="distributions.html"><a href="distributions.html#beta-distribution"><i class="fa fa-check"></i><b>4.3.1</b> Beta distribution</a></li>
<li class="chapter" data-level="4.3.2" data-path="distributions.html"><a href="distributions.html#normdist"><i class="fa fa-check"></i><b>4.3.2</b> Normal distribution</a></li>
<li class="chapter" data-level="4.3.3" data-path="distributions.html"><a href="distributions.html#gamma-distribution"><i class="fa fa-check"></i><b>4.3.3</b> Gamma distribution</a></li>
<li class="chapter" data-level="4.3.4" data-path="distributions.html"><a href="distributions.html#cauchydistri"><i class="fa fa-check"></i><b>4.3.4</b> Cauchy distribution</a></li>
<li class="chapter" data-level="4.3.5" data-path="distributions.html"><a href="distributions.html#t-distribution"><i class="fa fa-check"></i><b>4.3.5</b> t-distribution</a></li>
<li class="chapter" data-level="4.3.6" data-path="distributions.html"><a href="distributions.html#f-distribution"><i class="fa fa-check"></i><b>4.3.6</b> F-distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>5</b> Transformations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="transformations.html"><a href="transformations.html#some-r-specific-aspects"><i class="fa fa-check"></i><b>5.1</b> Some R-specific aspects</a></li>
<li class="chapter" data-level="5.2" data-path="transformations.html"><a href="transformations.html#first-aid-transformations"><i class="fa fa-check"></i><b>5.2</b> First-aid transformations</a></li>
<li class="chapter" data-level="5.3" data-path="transformations.html"><a href="transformations.html#logtransformation"><i class="fa fa-check"></i><b>5.3</b> Log-transformation with Stahel</a></li>
<li class="chapter" data-level="5.4" data-path="transformations.html"><a href="transformations.html#ztransformation"><i class="fa fa-check"></i><b>5.4</b> Centering and scaling (z-transformation)</a></li>
<li class="chapter" data-level="5.5" data-path="transformations.html"><a href="transformations.html#transformationspolynomials"><i class="fa fa-check"></i><b>5.5</b> Raw and orthogonal polynomials</a></li>
<li class="chapter" data-level="5.6" data-path="transformations.html"><a href="transformations.html#square-root-transformation"><i class="fa fa-check"></i><b>5.6</b> Square-root transformation</a></li>
<li class="chapter" data-level="5.7" data-path="transformations.html"><a href="transformations.html#arcsinus-square-root-transformation"><i class="fa fa-check"></i><b>5.7</b> Arcsinus-square-root transformation</a></li>
<li class="chapter" data-level="5.8" data-path="transformations.html"><a href="transformations.html#logit-transformation"><i class="fa fa-check"></i><b>5.8</b> Logit transformation</a></li>
<li class="chapter" data-level="5.9" data-path="transformations.html"><a href="transformations.html#categorizing-and-decategorizing"><i class="fa fa-check"></i><b>5.9</b> Categorizing and decategorizing</a></li>
<li class="chapter" data-level="5.10" data-path="transformations.html"><a href="transformations.html#transformationscircular"><i class="fa fa-check"></i><b>5.10</b> Sinus and cosinus transformation for circular variables</a></li>
<li class="chapter" data-level="5.11" data-path="transformations.html"><a href="transformations.html#cloglog-probit-inverse-transformation"><i class="fa fa-check"></i><b>5.11</b> Cloglog, probit, inverse transformation</a></li>
<li class="chapter" data-level="5.12" data-path="transformations.html"><a href="transformations.html#identity-transformation"><i class="fa fa-check"></i><b>5.12</b> Identity transformation</a></li>
<li class="chapter" data-level="5.13" data-path="transformations.html"><a href="transformations.html#transformations-on-the-outcome-variable"><i class="fa fa-check"></i><b>5.13</b> Transformations on the outcome variable</a></li>
<li class="chapter" data-level="5.14" data-path="transformations.html"><a href="transformations.html#back-transformation"><i class="fa fa-check"></i><b>5.14</b> Back-transformation</a></li>
<li class="chapter" data-level="5.15" data-path="transformations.html"><a href="transformations.html#applythesametransformation"><i class="fa fa-check"></i><b>5.15</b> Applying the transformations to new data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproducibleresearch.html"><a href="reproducibleresearch.html"><i class="fa fa-check"></i><b>6</b> Reproducible research</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reproducibleresearch.html"><a href="reproducibleresearch.html#summary-1"><i class="fa fa-check"></i><b>6.1</b> Summary</a></li>
<li class="chapter" data-level="6.2" data-path="reproducibleresearch.html"><a href="reproducibleresearch.html#further-reading-2"><i class="fa fa-check"></i><b>6.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="furthertopics.html"><a href="furthertopics.html"><i class="fa fa-check"></i><b>7</b> Further topics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="furthertopics.html"><a href="furthertopics.html#bioacoustic-analyse"><i class="fa fa-check"></i><b>7.1</b> Bioacoustic analyse</a></li>
<li class="chapter" data-level="7.2" data-path="furthertopics.html"><a href="furthertopics.html#python"><i class="fa fa-check"></i><b>7.2</b> Python</a></li>
<li class="chapter" data-level="7.3" data-path="furthertopics.html"><a href="furthertopics.html#some-r"><i class="fa fa-check"></i><b>7.3</b> Some R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="furthertopics.html"><a href="furthertopics.html#date-on-x-axis"><i class="fa fa-check"></i><b>7.3.1</b> Date on x-axis</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II BAYESIAN DATA ANALYSIS</b></span></li>
<li class="chapter" data-level="8" data-path="PART-II.html"><a href="PART-II.html"><i class="fa fa-check"></i><b>8</b> Introduction to PART II</a>
<ul>
<li class="chapter" data-level="" data-path="PART-II.html"><a href="PART-II.html#further-reading-3"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html"><i class="fa fa-check"></i><b>9</b> The Bayesian paradigm and likelihood in a frequentist and Bayesian framework</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html#short-historical-overview"><i class="fa fa-check"></i><b>9.1</b> Short historical overview</a></li>
<li class="chapter" data-level="9.2" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html#the-bayesian-way"><i class="fa fa-check"></i><b>9.2</b> The Bayesian way</a></li>
<li class="chapter" data-level="9.3" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html#likelihood"><i class="fa fa-check"></i><b>9.3</b> Likelihood</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html#theory"><i class="fa fa-check"></i><b>9.3.1</b> Theory</a></li>
<li class="chapter" data-level="9.3.2" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html#the-maximum-likelihood-method"><i class="fa fa-check"></i><b>9.3.2</b> The maximum likelihood method</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html#the-log-pointwise-predictive-density"><i class="fa fa-check"></i><b>9.4</b> The log pointwise predictive density</a></li>
<li class="chapter" data-level="9.5" data-path="bayesian_paradigm.html"><a href="bayesian_paradigm.html#further-reading-4"><i class="fa fa-check"></i><b>9.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>10</b> Prior distributions and prior sensitivity analyses</a>
<ul>
<li class="chapter" data-level="10.1" data-path="priors.html"><a href="priors.html#introduction-1"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="priors.html"><a href="priors.html#choosepriors"><i class="fa fa-check"></i><b>10.2</b> How to choose a prior</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="priors.html"><a href="priors.html#priors-for-variance-parameters"><i class="fa fa-check"></i><b>10.2.1</b> Priors for variance parameters</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="priors.html"><a href="priors.html#prior-sensitivity"><i class="fa fa-check"></i><b>10.3</b> Prior sensitivity</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>11</b> Normal Linear Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lm.html"><a href="lm.html#linear-regression"><i class="fa fa-check"></i><b>11.1</b> Linear regression</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="lm.html"><a href="lm.html#background"><i class="fa fa-check"></i><b>11.1.1</b> Background</a></li>
<li class="chapter" data-level="11.1.2" data-path="lm.html"><a href="lm.html#fitting-a-linear-regression-in-r"><i class="fa fa-check"></i><b>11.1.2</b> Fitting a linear regression in R</a></li>
<li class="chapter" data-level="11.1.3" data-path="lm.html"><a href="lm.html#presenting-the-results"><i class="fa fa-check"></i><b>11.1.3</b> Presenting the results</a></li>
<li class="chapter" data-level="11.1.4" data-path="lm.html"><a href="lm.html#interpretation-of-the-r-summary-output"><i class="fa fa-check"></i><b>11.1.4</b> Interpretation of the R summary output</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="lm.html"><a href="lm.html#linear-model-with-one-categorical-predictor-one-way-anova"><i class="fa fa-check"></i><b>11.2</b> Linear model with one categorical predictor (one-way ANOVA)</a></li>
<li class="chapter" data-level="11.3" data-path="lm.html"><a href="lm.html#other-variants-of-normal-linear-models"><i class="fa fa-check"></i><b>11.3</b> Other variants of normal linear models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="lm.html"><a href="lm.html#twowayanova"><i class="fa fa-check"></i><b>11.3.1</b> Linear model with two categorical predictors (two-way ANOVA)</a></li>
<li class="chapter" data-level="11.3.2" data-path="lm.html"><a href="lm.html#a-linear-model-with-a-categorical-and-a-numeric-predictor-ancova"><i class="fa fa-check"></i><b>11.3.2</b> A linear model with a categorical and a numeric predictor (ANCOVA)</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="lm.html"><a href="lm.html#collinearity"><i class="fa fa-check"></i><b>11.4</b> Partial coefficients and some comments on collinearity</a></li>
<li class="chapter" data-level="11.5" data-path="lm.html"><a href="lm.html#orderedfactors"><i class="fa fa-check"></i><b>11.5</b> Ordered factors and contrasts</a></li>
<li class="chapter" data-level="11.6" data-path="lm.html"><a href="lm.html#lmpolynomials"><i class="fa fa-check"></i><b>11.6</b> Quadratic and higher polynomial terms</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="residualanalysis.html"><a href="residualanalysis.html"><i class="fa fa-check"></i><b>12</b> Assessing model assumptions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="residualanalysis.html"><a href="residualanalysis.html#model-assumptions"><i class="fa fa-check"></i><b>12.1</b> Model assumptions</a></li>
<li class="chapter" data-level="12.2" data-path="residualanalysis.html"><a href="residualanalysis.html#independent-and-identically-distributed"><i class="fa fa-check"></i><b>12.2</b> Independent and identically distributed</a></li>
<li class="chapter" data-level="12.3" data-path="residualanalysis.html"><a href="residualanalysis.html#qqplot"><i class="fa fa-check"></i><b>12.3</b> The QQ-plot</a></li>
<li class="chapter" data-level="12.4" data-path="residualanalysis.html"><a href="residualanalysis.html#tempautocorrelation"><i class="fa fa-check"></i><b>12.4</b> Temporal autocorrelation</a></li>
<li class="chapter" data-level="12.5" data-path="residualanalysis.html"><a href="residualanalysis.html#spatialautocorrelation"><i class="fa fa-check"></i><b>12.5</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="12.6" data-path="residualanalysis.html"><a href="residualanalysis.html#Heteroscedasticity"><i class="fa fa-check"></i><b>12.6</b> Heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="lmer.html"><a href="lmer.html"><i class="fa fa-check"></i><b>13</b> Linear mixed effect models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="lmer.html"><a href="lmer.html#background-2"><i class="fa fa-check"></i><b>13.1</b> Background</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="lmer.html"><a href="lmer.html#why-mixed-effects-models"><i class="fa fa-check"></i><b>13.1.1</b> Why mixed effects models?</a></li>
<li class="chapter" data-level="13.1.2" data-path="lmer.html"><a href="lmer.html#random-factors-and-partial-pooling"><i class="fa fa-check"></i><b>13.1.2</b> Random factors and partial pooling</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="lmer.html"><a href="lmer.html#fitting-a-normal-linear-mixed-model-in-r"><i class="fa fa-check"></i><b>13.2</b> Fitting a normal linear mixed model in R</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="lmer.html"><a href="lmer.html#background-3"><i class="fa fa-check"></i><b>13.2.1</b> Background</a></li>
<li class="chapter" data-level="13.2.2" data-path="lmer.html"><a href="lmer.html#fitting-a-normal-linear-mixed-model-using-lmer"><i class="fa fa-check"></i><b>13.2.2</b> Fitting a normal linear mixed model using lmer</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="lmer.html"><a href="lmer.html#restricted-maximum-likelihood-estimation-reml"><i class="fa fa-check"></i><b>13.3</b> Restricted maximum likelihood estimation (REML)</a></li>
<li class="chapter" data-level="13.4" data-path="lmer.html"><a href="lmer.html#assessing-model-assumptions"><i class="fa fa-check"></i><b>13.4</b> Assessing model assumptions</a></li>
<li class="chapter" data-level="13.5" data-path="lmer.html"><a href="lmer.html#presenting-the-results-1"><i class="fa fa-check"></i><b>13.5</b> Presenting the results</a></li>
<li class="chapter" data-level="13.6" data-path="lmer.html"><a href="lmer.html#random-intercept-and-slope"><i class="fa fa-check"></i><b>13.6</b> Random intercept and slope</a></li>
<li class="chapter" data-level="13.7" data-path="lmer.html"><a href="lmer.html#nested-and-crossed-random-effects"><i class="fa fa-check"></i><b>13.7</b> Nested and crossed random effects</a></li>
<li class="chapter" data-level="13.8" data-path="lmer.html"><a href="lmer.html#model-selection-in-mixed-models"><i class="fa fa-check"></i><b>13.8</b> Model selection in mixed models</a></li>
<li class="chapter" data-level="13.9" data-path="lmer.html"><a href="lmer.html#further-reading-5"><i class="fa fa-check"></i><b>13.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>14</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="glm.html"><a href="glm.html#introduction-2"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="glm.html"><a href="glm.html#bernoulli-model"><i class="fa fa-check"></i><b>14.2</b> Bernoulli model</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="glm.html"><a href="glm.html#background-4"><i class="fa fa-check"></i><b>14.2.1</b> Background</a></li>
<li class="chapter" data-level="14.2.2" data-path="glm.html"><a href="glm.html#fitting-a-bernoulli-model-in-r"><i class="fa fa-check"></i><b>14.2.2</b> Fitting a Bernoulli model in R</a></li>
<li class="chapter" data-level="14.2.3" data-path="glm.html"><a href="glm.html#assessing-model-assumptions-in-a-bernoulli-model"><i class="fa fa-check"></i><b>14.2.3</b> Assessing model assumptions in a Bernoulli model</a></li>
<li class="chapter" data-level="14.2.4" data-path="glm.html"><a href="glm.html#visualising-the-results"><i class="fa fa-check"></i><b>14.2.4</b> Visualising the results</a></li>
<li class="chapter" data-level="14.2.5" data-path="glm.html"><a href="glm.html#some-remarks"><i class="fa fa-check"></i><b>14.2.5</b> Some remarks</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="glm.html"><a href="glm.html#binomial-model"><i class="fa fa-check"></i><b>14.3</b> Binomial model</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="glm.html"><a href="glm.html#background-5"><i class="fa fa-check"></i><b>14.3.1</b> Background</a></li>
<li class="chapter" data-level="14.3.2" data-path="glm.html"><a href="glm.html#fitting-a-binomial-model-in-r"><i class="fa fa-check"></i><b>14.3.2</b> Fitting a binomial model in R</a></li>
<li class="chapter" data-level="14.3.3" data-path="glm.html"><a href="glm.html#assessing-assumptions-in-a-binomial-model"><i class="fa fa-check"></i><b>14.3.3</b> Assessing assumptions in a binomial model</a></li>
<li class="chapter" data-level="14.3.4" data-path="glm.html"><a href="glm.html#visualising-the-results-1"><i class="fa fa-check"></i><b>14.3.4</b> Visualising the results</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="glm.html"><a href="glm.html#poisson-model"><i class="fa fa-check"></i><b>14.4</b> Poisson model</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="glm.html"><a href="glm.html#background-6"><i class="fa fa-check"></i><b>14.4.1</b> Background</a></li>
<li class="chapter" data-level="14.4.2" data-path="glm.html"><a href="glm.html#fitting-a-poisson-model-in-r"><i class="fa fa-check"></i><b>14.4.2</b> Fitting a Poisson model in R</a></li>
<li class="chapter" data-level="14.4.3" data-path="glm.html"><a href="glm.html#assessing-model-assumptions-1"><i class="fa fa-check"></i><b>14.4.3</b> Assessing model assumptions</a></li>
<li class="chapter" data-level="14.4.4" data-path="glm.html"><a href="glm.html#visualising-results"><i class="fa fa-check"></i><b>14.4.4</b> Visualising results</a></li>
<li class="chapter" data-level="14.4.5" data-path="glm.html"><a href="glm.html#modeling-rates-and-densities-poisson-model-with-an-offset"><i class="fa fa-check"></i><b>14.4.5</b> Modeling rates and densities: Poisson model with an offset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="glmm.html"><a href="glmm.html"><i class="fa fa-check"></i><b>15</b> Generalized linear mixed models</a>
<ul>
<li class="chapter" data-level="15.1" data-path="glmm.html"><a href="glmm.html#background-7"><i class="fa fa-check"></i><b>15.1</b> Background</a></li>
<li class="chapter" data-level="15.2" data-path="glmm.html"><a href="glmm.html#binomial-mixed-model"><i class="fa fa-check"></i><b>15.2</b> Binomial mixed model</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="glmm.html"><a href="glmm.html#background-8"><i class="fa fa-check"></i><b>15.2.1</b> Background</a></li>
<li class="chapter" data-level="15.2.2" data-path="glmm.html"><a href="glmm.html#fitting-a-binomial-mixed-model-in-r"><i class="fa fa-check"></i><b>15.2.2</b> Fitting a binomial mixed model in R</a></li>
<li class="chapter" data-level="15.2.3" data-path="glmm.html"><a href="glmm.html#presenting-the-results-2"><i class="fa fa-check"></i><b>15.2.3</b> Presenting the results</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="glmm.html"><a href="glmm.html#poisson-mixed-model"><i class="fa fa-check"></i><b>15.3</b> Poisson mixed model</a></li>
<li class="chapter" data-level="15.4" data-path="glmm.html"><a href="glmm.html#summary-2"><i class="fa fa-check"></i><b>15.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modelchecking.html"><a href="modelchecking.html"><i class="fa fa-check"></i><b>16</b> Posterior predictive model checking</a></li>
<li class="chapter" data-level="17" data-path="model_comparison.html"><a href="model_comparison.html"><i class="fa fa-check"></i><b>17</b> Model comparison and multimodel inference</a>
<ul>
<li class="chapter" data-level="17.1" data-path="model_comparison.html"><a href="model_comparison.html#when-and-why-we-compare-models-and-why-model-selection-is-difficult"><i class="fa fa-check"></i><b>17.1</b> When and why we compare models and why model selection is difficult</a></li>
<li class="chapter" data-level="17.2" data-path="model_comparison.html"><a href="model_comparison.html#methods-for-model-commparison"><i class="fa fa-check"></i><b>17.2</b> Methods for model commparison</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="model_comparison.html"><a href="model_comparison.html#cross-validation"><i class="fa fa-check"></i><b>17.2.1</b> Cross-validation</a></li>
<li class="chapter" data-level="17.2.2" data-path="model_comparison.html"><a href="model_comparison.html#information-criteria-akaike-information-criterion-and-widely-applicable-information-criterion"><i class="fa fa-check"></i><b>17.2.2</b> Information criteria: Akaike information criterion and widely applicable information criterion</a></li>
<li class="chapter" data-level="17.2.3" data-path="model_comparison.html"><a href="model_comparison.html#other-information-criteria"><i class="fa fa-check"></i><b>17.2.3</b> Other information criteria</a></li>
<li class="chapter" data-level="17.2.4" data-path="model_comparison.html"><a href="model_comparison.html#bayes-factors-and-posterior-model-probabilities"><i class="fa fa-check"></i><b>17.2.4</b> Bayes factors and posterior model probabilities</a></li>
<li class="chapter" data-level="17.2.5" data-path="model_comparison.html"><a href="model_comparison.html#model-based-methods-to-obtain-posterior-model-probabilities-and-inclusion-probabilities"><i class="fa fa-check"></i><b>17.2.5</b> Model-based methods to obtain posterior model probabilities and inclusion probabilities</a></li>
<li class="chapter" data-level="17.2.6" data-path="model_comparison.html"><a href="model_comparison.html#least-absolute-shrinkage-and-selection-operator-lasso-and-ridge-regression"><i class="fa fa-check"></i><b>17.2.6</b> Least absolute shrinkage and selection operator (LASSO) and ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="model_comparison.html"><a href="model_comparison.html#multimodel-inference"><i class="fa fa-check"></i><b>17.3</b> Multimodel inference</a></li>
<li class="chapter" data-level="17.4" data-path="model_comparison.html"><a href="model_comparison.html#which-method-to-choose-and-which-strategy-to-follow"><i class="fa fa-check"></i><b>17.4</b> Which method to choose and which strategy to follow?</a></li>
<li class="chapter" data-level="17.5" data-path="model_comparison.html"><a href="model_comparison.html#further-reading-6"><i class="fa fa-check"></i><b>17.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>18</b> MCMC using Stan via rstanarm, brms or rstan</a>
<ul>
<li class="chapter" data-level="18.1" data-path="stan.html"><a href="stan.html#background-9"><i class="fa fa-check"></i><b>18.1</b> Background</a></li>
<li class="chapter" data-level="18.2" data-path="stan.html"><a href="stan.html#assessing-convergence-of-the-markov-chains-and-trouble-shooting-warnings-of-stan"><i class="fa fa-check"></i><b>18.2</b> Assessing convergence of the Markov chains and trouble shooting warnings of Stan</a></li>
<li class="chapter" data-level="18.3" data-path="stan.html"><a href="stan.html#using-stan-via-rstan"><i class="fa fa-check"></i><b>18.3</b> Using Stan via rstan</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="stan.html"><a href="stan.html#firststanmod"><i class="fa fa-check"></i><b>18.3.1</b> Writing a Stan model</a></li>
<li class="chapter" data-level="18.3.2" data-path="stan.html"><a href="stan.html#run-stan-from-r-using-rstan"><i class="fa fa-check"></i><b>18.3.2</b> Run Stan from R using rstan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#further-reading-7"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ridge_regression.html"><a href="ridge_regression.html"><i class="fa fa-check"></i><b>19</b> Ridge Regression</a>
<ul>
<li class="chapter" data-level="19.1" data-path="ridge_regression.html"><a href="ridge_regression.html#introduction-3"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="SEM.html"><a href="SEM.html"><i class="fa fa-check"></i><b>20</b> Structural equation models</a>
<ul>
<li class="chapter" data-level="20.1" data-path="SEM.html"><a href="SEM.html#introduction-4"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="spatial_glmm.html"><a href="spatial_glmm.html"><i class="fa fa-check"></i><b>21</b> Modeling spatial data using GLMM</a>
<ul>
<li class="chapter" data-level="21.1" data-path="spatial_glmm.html"><a href="spatial_glmm.html#introduction-5"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="spatial_glmm.html"><a href="spatial_glmm.html#summary-3"><i class="fa fa-check"></i><b>21.2</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>III ECOLOGICAL MODELS</b></span></li>
<li class="chapter" data-level="22" data-path="PART-III.html"><a href="PART-III.html"><i class="fa fa-check"></i><b>22</b> Introduction to PART III</a>
<ul>
<li class="chapter" data-level="22.1" data-path="PART-III.html"><a href="PART-III.html#model-notations"><i class="fa fa-check"></i><b>22.1</b> Model notations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html"><i class="fa fa-check"></i><b>23</b> Zero-inflated Poisson mixed model</a>
<ul>
<li class="chapter" data-level="23.1" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#introduction-6"><i class="fa fa-check"></i><b>23.1</b> Introduction</a></li>
<li class="chapter" data-level="23.2" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#example-data"><i class="fa fa-check"></i><b>23.2</b> Example data</a></li>
<li class="chapter" data-level="23.3" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#model"><i class="fa fa-check"></i><b>23.3</b> Model</a></li>
<li class="chapter" data-level="23.4" data-path="zeroinflated-poisson-lmm.html"><a href="zeroinflated-poisson-lmm.html#further-packages-and-readings"><i class="fa fa-check"></i><b>23.4</b> Further packages and readings</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="dailynestsurv.html"><a href="dailynestsurv.html"><i class="fa fa-check"></i><b>24</b> Daily nest survival</a>
<ul>
<li class="chapter" data-level="24.1" data-path="dailynestsurv.html"><a href="dailynestsurv.html#background-10"><i class="fa fa-check"></i><b>24.1</b> Background</a></li>
<li class="chapter" data-level="24.2" data-path="dailynestsurv.html"><a href="dailynestsurv.html#models-for-estimating-daily-nest-survival"><i class="fa fa-check"></i><b>24.2</b> Models for estimating daily nest survival</a></li>
<li class="chapter" data-level="24.3" data-path="dailynestsurv.html"><a href="dailynestsurv.html#known-fate-model"><i class="fa fa-check"></i><b>24.3</b> Known fate model</a></li>
<li class="chapter" data-level="24.4" data-path="dailynestsurv.html"><a href="dailynestsurv.html#dailynestsurvstan"><i class="fa fa-check"></i><b>24.4</b> The Stan model</a></li>
<li class="chapter" data-level="24.5" data-path="dailynestsurv.html"><a href="dailynestsurv.html#prepare-data-and-run-stan"><i class="fa fa-check"></i><b>24.5</b> Prepare data and run Stan</a></li>
<li class="chapter" data-level="24.6" data-path="dailynestsurv.html"><a href="dailynestsurv.html#check-convergence"><i class="fa fa-check"></i><b>24.6</b> Check convergence</a></li>
<li class="chapter" data-level="24.7" data-path="dailynestsurv.html"><a href="dailynestsurv.html#look-at-results"><i class="fa fa-check"></i><b>24.7</b> Look at results</a></li>
<li class="chapter" data-level="24.8" data-path="dailynestsurv.html"><a href="dailynestsurv.html#known-fate-model-for-irregular-nest-controls"><i class="fa fa-check"></i><b>24.8</b> Known fate model for irregular nest controls</a></li>
<li class="chapter" data-level="" data-path="dailynestsurv.html"><a href="dailynestsurv.html#further-reading-8"><i class="fa fa-check"></i>Further reading</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="cjs_with_mix.html"><a href="cjs_with_mix.html"><i class="fa fa-check"></i><b>25</b> Capture-mark recapture model with a mixture structure to account for missing sex-variable for parts of the individuals</a>
<ul>
<li class="chapter" data-level="25.1" data-path="cjs_with_mix.html"><a href="cjs_with_mix.html#introduction-7"><i class="fa fa-check"></i><b>25.1</b> Introduction</a></li>
<li class="chapter" data-level="25.2" data-path="cjs_with_mix.html"><a href="cjs_with_mix.html#data-description"><i class="fa fa-check"></i><b>25.2</b> Data description</a></li>
<li class="chapter" data-level="25.3" data-path="cjs_with_mix.html"><a href="cjs_with_mix.html#model-description"><i class="fa fa-check"></i><b>25.3</b> Model description</a></li>
<li class="chapter" data-level="25.4" data-path="cjs_with_mix.html"><a href="cjs_with_mix.html#the-stan-code"><i class="fa fa-check"></i><b>25.4</b> The Stan code</a></li>
<li class="chapter" data-level="25.5" data-path="cjs_with_mix.html"><a href="cjs_with_mix.html#call-stan-from-r-check-convergence-and-look-at-results"><i class="fa fa-check"></i><b>25.5</b> Call Stan from R, check convergence and look at results</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="samplesize.html"><a href="samplesize.html"><i class="fa fa-check"></i><b>26</b> What sample size?</a>
<ul>
<li class="chapter" data-level="26.1" data-path="samplesize.html"><a href="samplesize.html#introduction-8"><i class="fa fa-check"></i><b>26.1</b> Introduction</a></li>
</ul></li>
<li class="part"><span><b>IV APPENDICES</b></span></li>
<li class="chapter" data-level="" data-path="referenzen.html"><a href="referenzen.html"><i class="fa fa-check"></i>Referenzen</a></li>
<li class="divider"></li>
</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis in Ecology with R and Stan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dailynestsurv" class="section level1 hasAnchor" number="24">
<h1><span class="header-section-number">24</span> Daily nest survival<a href="dailynestsurv.html#dailynestsurv" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- todo: explain why we need to start with first at day of detection, give literatur to describe the known fate model (e.g. King's book) -->
<div id="background-10" class="section level2 hasAnchor" number="24.1">
<h2><span class="header-section-number">24.1</span> Background<a href="dailynestsurv.html#background-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Analyses of nest survival is important for understanding the mechanisms of population dynamics. The life-span of a nest could be used as a measure of nest survival. However, this measure very often is biased towards nests that survived longer because these nests are detected by the ornithologists with higher probability <span class="citation">(<a href="referenzen.html#ref-Mayfield.1975">Mayfield 1975</a>)</span>. In order not to overestimate nest survival, daily nest survival conditional on survival to the previous day can be estimated.</p>
</div>
<div id="models-for-estimating-daily-nest-survival" class="section level2 hasAnchor" number="24.2">
<h2><span class="header-section-number">24.2</span> Models for estimating daily nest survival<a href="dailynestsurv.html#models-for-estimating-daily-nest-survival" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What model is best used depends on the type of data available. Data may look:</p>
<ol style="list-style-type: decimal">
<li>Regular (e.g. daily) nest controls, all nests monitored from their first egg onward<br />
</li>
<li>Regular nest controls, nests found during the course of the study at different stages and nestling ages<br />
</li>
<li>Irregular nest controls, all nests monitored from their first egg onward<br />
</li>
<li>Irregular nest controls, nests found during the course of the study at different stages and nestling ages</li>
</ol>
<table>
<caption><span id="tab:nestsurvmod">Table 24.1: </span> Models useful for estimating daily nest survival. Data numbers correspond to the descriptions above.</caption>
<colgroup>
<col width="17%" />
<col width="41%" />
<col width="41%" />
</colgroup>
<thead>
<tr>
<th align="left">Model</th>
<th align="left">Data</th>
<th align="left">Software, R-code</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Binomial or Bernoulli model</td>
<td align="left">1, (3)</td>
<td align="left"><code>glm</code>, <code>glmer</code>,…</td>
</tr>
<tr>
<td align="left">Cox proportional hazard model</td>
<td align="left">1,2,3,4</td>
<td align="left"><code>brm</code>, soon: <code>stan_cox</code></td>
</tr>
<tr>
<td align="left">Known fate model</td>
<td align="left">1, 2</td>
<td align="left">Stan code below</td>
</tr>
<tr>
<td align="left">Known fate model</td>
<td align="left">3, 4</td>
<td align="left">Stan code below</td>
</tr>
<tr>
<td align="left">Logistic exposure model</td>
<td align="left">1,2,3,4</td>
<td align="left"><code>glm</code>, <code>glmer</code>using a link function that depends on exposure time</td>
</tr>
</tbody>
</table>
<p><span class="citation">Shaffer (<a href="referenzen.html#ref-Shaffer.2004">2004</a>)</span> explains how to adapt the link function in a Bernoulli model to account for having found the nests at different nest ages (exposure time). Ben Bolker explains how to implement the logistic exposure model in R <a href="https://rpubs.com/bbolker/logregexp">here</a>.</p>
</div>
<div id="known-fate-model" class="section level2 hasAnchor" number="24.3">
<h2><span class="header-section-number">24.3</span> Known fate model<a href="dailynestsurv.html#known-fate-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A natural model that allows estimating daily nest survival is the known-fate survival model. It is a Markov model that models the state of a nest <span class="math inline">\(i\)</span> at day <span class="math inline">\(t\)</span> (whether it is alive, <span class="math inline">\(y_{it}=1\)</span> or not <span class="math inline">\(y_{it}=0\)</span>) as a Bernoulli variable dependent on the state of the nest the day before.<br />
<span class="math display">\[ y_{it} \sim Bernoulli(y_{it-1}S_{it})\]</span>
The daily nest survival <span class="math inline">\(S_{it}\)</span> can be linearly related to predictor variables that are measured on the nest or on the day level.</p>
<p><span class="math display">\[logit(S_{it}) = \textbf{X} \beta\]</span>
It is also possible to add random effects if needed.</p>
</div>
<div id="dailynestsurvstan" class="section level2 hasAnchor" number="24.4">
<h2><span class="header-section-number">24.4</span> The Stan model<a href="dailynestsurv.html#dailynestsurvstan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following Stan model code is saved as <code>daily_nest_survival.stan</code>.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb323-1"><a href="dailynestsurv.html#cb323-1" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb323-2"><a href="dailynestsurv.html#cb323-2" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; Nnests;                  <span class="co">// number of nests</span></span>
<span id="cb323-3"><a href="dailynestsurv.html#cb323-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; last[Nnests];            <span class="co">// day of last observation (alive or dead)</span></span>
<span id="cb323-4"><a href="dailynestsurv.html#cb323-4" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; first[Nnests];           <span class="co">// day of first observation (alive or dead)</span></span>
<span id="cb323-5"><a href="dailynestsurv.html#cb323-5" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; maxage;                  <span class="co">// maximum of last</span></span>
<span id="cb323-6"><a href="dailynestsurv.html#cb323-6" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; y[Nnests, maxage];       <span class="co">// indicator of alive nests</span></span>
<span id="cb323-7"><a href="dailynestsurv.html#cb323-7" tabindex="-1"></a>  <span class="dt">real</span> cover[Nnests];                 <span class="co">// a covariate of the nest</span></span>
<span id="cb323-8"><a href="dailynestsurv.html#cb323-8" tabindex="-1"></a>  <span class="dt">real</span> age[maxage];                   <span class="co">// a covariate of the date</span></span>
<span id="cb323-9"><a href="dailynestsurv.html#cb323-9" tabindex="-1"></a>}</span>
<span id="cb323-10"><a href="dailynestsurv.html#cb323-10" tabindex="-1"></a></span>
<span id="cb323-11"><a href="dailynestsurv.html#cb323-11" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb323-12"><a href="dailynestsurv.html#cb323-12" tabindex="-1"></a>  <span class="dt">vector</span>[<span class="dv">3</span>] b;                          <span class="co">// coef of linear pred for S</span></span>
<span id="cb323-13"><a href="dailynestsurv.html#cb323-13" tabindex="-1"></a>}</span>
<span id="cb323-14"><a href="dailynestsurv.html#cb323-14" tabindex="-1"></a></span>
<span id="cb323-15"><a href="dailynestsurv.html#cb323-15" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb323-16"><a href="dailynestsurv.html#cb323-16" tabindex="-1"></a>  <span class="dt">real</span> S[Nnests, maxage<span class="dv">-1</span>];             <span class="co">// survival probability</span></span>
<span id="cb323-17"><a href="dailynestsurv.html#cb323-17" tabindex="-1"></a>                </span>
<span id="cb323-18"><a href="dailynestsurv.html#cb323-18" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span>:Nnests){  </span>
<span id="cb323-19"><a href="dailynestsurv.html#cb323-19" tabindex="-1"></a>    <span class="cf">for</span>(t <span class="cf">in</span> first[i]:(last[i]-<span class="dv">1</span>)){ </span>
<span id="cb323-20"><a href="dailynestsurv.html#cb323-20" tabindex="-1"></a>      S[i,t] = inv_logit(b[<span class="dv">1</span>] + b[<span class="dv">2</span>]*cover[i] + b[<span class="dv">3</span>]*age[t]); </span>
<span id="cb323-21"><a href="dailynestsurv.html#cb323-21" tabindex="-1"></a>    }</span>
<span id="cb323-22"><a href="dailynestsurv.html#cb323-22" tabindex="-1"></a>  }</span>
<span id="cb323-23"><a href="dailynestsurv.html#cb323-23" tabindex="-1"></a></span>
<span id="cb323-24"><a href="dailynestsurv.html#cb323-24" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb323-25"><a href="dailynestsurv.html#cb323-25" tabindex="-1"></a>  b[<span class="dv">1</span>]~normal(<span class="dv">0</span>,<span class="dv">5</span>);</span>
<span id="cb323-26"><a href="dailynestsurv.html#cb323-26" tabindex="-1"></a>  b[<span class="dv">2</span>]~normal(<span class="dv">0</span>,<span class="dv">3</span>);</span>
<span id="cb323-27"><a href="dailynestsurv.html#cb323-27" tabindex="-1"></a>  b[<span class="dv">3</span>]~normal(<span class="dv">0</span>,<span class="dv">3</span>);  </span>
<span id="cb323-28"><a href="dailynestsurv.html#cb323-28" tabindex="-1"></a></span>
<span id="cb323-29"><a href="dailynestsurv.html#cb323-29" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb323-30"><a href="dailynestsurv.html#cb323-30" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:Nnests) {</span>
<span id="cb323-31"><a href="dailynestsurv.html#cb323-31" tabindex="-1"></a>    <span class="cf">for</span>(t <span class="cf">in</span> (first[i]+<span class="dv">1</span>):last[i]){</span>
<span id="cb323-32"><a href="dailynestsurv.html#cb323-32" tabindex="-1"></a>      y[i,t]~bernoulli(y[i,t<span class="dv">-1</span>]*S[i,t<span class="dv">-1</span>]);</span>
<span id="cb323-33"><a href="dailynestsurv.html#cb323-33" tabindex="-1"></a>    }</span>
<span id="cb323-34"><a href="dailynestsurv.html#cb323-34" tabindex="-1"></a>  }</span>
<span id="cb323-35"><a href="dailynestsurv.html#cb323-35" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="prepare-data-and-run-stan" class="section level2 hasAnchor" number="24.5">
<h2><span class="header-section-number">24.5</span> Prepare data and run Stan<a href="dailynestsurv.html#prepare-data-and-run-stan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data is from <span class="citation">Grendelmeier, Arlettaz, and Pasinelli (<a href="referenzen.html#ref-Grendelmeier.2018">2018</a>)</span>.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="dailynestsurv.html#cb324-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;RData/nest_surv_data.rda&quot;</span>)</span>
<span id="cb324-2"><a href="dailynestsurv.html#cb324-2" tabindex="-1"></a><span class="fu">str</span>(datax)</span></code></pre></div>
<pre><code>## List of 7
##  $ y     : int [1:156, 1:31] 1 NA 1 NA 1 NA NA 1 1 1 ...
##  $ Nnests: int 156
##  $ last  : int [1:156] 26 30 31 27 31 30 31 31 31 31 ...
##  $ first : int [1:156] 1 14 1 3 1 24 18 1 1 1 ...
##  $ cover : num [1:156] -0.943 -0.215 0.149 0.149 -0.215 ...
##  $ age   : num [1:31] -1.65 -1.54 -1.43 -1.32 -1.21 ...
##  $ maxage: int 31</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="dailynestsurv.html#cb326-1" tabindex="-1"></a>datax<span class="sc">$</span>y[<span class="fu">is.na</span>(datax<span class="sc">$</span>y)] <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Stan does not allow for NA&#39;s in the outcome</span></span></code></pre></div>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="dailynestsurv.html#cb327-1" tabindex="-1"></a><span class="co"># Run STAN</span></span>
<span id="cb327-2"><a href="dailynestsurv.html#cb327-2" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb327-3"><a href="dailynestsurv.html#cb327-3" tabindex="-1"></a></span>
<span id="cb327-4"><a href="dailynestsurv.html#cb327-4" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">file =</span> <span class="st">&quot;stanmodels/daily_nest_survival.stan&quot;</span>, <span class="at">data=</span>datax, </span>
<span id="cb327-5"><a href="dailynestsurv.html#cb327-5" tabindex="-1"></a>            <span class="at">chains=</span><span class="dv">5</span>, <span class="at">iter=</span><span class="dv">2500</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">adapt_delta=</span><span class="fl">0.9</span>), <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="check-convergence" class="section level2 hasAnchor" number="24.6">
<h2><span class="header-section-number">24.6</span> Check convergence<a href="dailynestsurv.html#check-convergence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We love exploring the performance of the Markov chains by using the function <code>launch_shinystan</code> from the package <code>shinystan</code>.</p>
</div>
<div id="look-at-results" class="section level2 hasAnchor" number="24.7">
<h2><span class="header-section-number">24.7</span> Look at results<a href="dailynestsurv.html#look-at-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It looks like cover does not affect daily nest survival, but daily nest survival decreases with the age of the nestlings.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="dailynestsurv.html#cb328-1" tabindex="-1"></a><span class="co">#launch_shinystan(mod)</span></span>
<span id="cb328-2"><a href="dailynestsurv.html#cb328-2" tabindex="-1"></a><span class="fu">print</span>(mod)</span></code></pre></div>
<pre><code>## Inference for Stan model: anon_model.
## 5 chains, each with iter=2500; warmup=1250; thin=1; 
## post-warmup draws per chain=1250, total post-warmup draws=6250.
## 
##         mean se_mean   sd    2.5%     25%     50%     75%   97.5% n_eff Rhat
## b[1]    4.04    0.00 0.15    3.76    3.94    4.04    4.14    4.35  3828    1
## b[2]    0.00    0.00 0.13   -0.25   -0.09   -0.01    0.08    0.25  4524    1
## b[3]   -0.70    0.00 0.16   -1.02   -0.81   -0.69   -0.59   -0.39  3956    1
## lp__ -298.98    0.03 1.30 -302.39 -299.52 -298.65 -298.05 -297.53  2659    1
## 
## Samples were drawn using NUTS(diag_e) at Thu Jan 19 22:33:33 2023.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="dailynestsurv.html#cb330-1" tabindex="-1"></a><span class="co"># effect plot</span></span>
<span id="cb330-2"><a href="dailynestsurv.html#cb330-2" tabindex="-1"></a>bsim <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mod)</span>
<span id="cb330-3"><a href="dailynestsurv.html#cb330-3" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="fu">nrow</span>(bsim)</span>
<span id="cb330-4"><a href="dailynestsurv.html#cb330-4" tabindex="-1"></a></span>
<span id="cb330-5"><a href="dailynestsurv.html#cb330-5" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age=</span><span class="fu">seq</span>(<span class="dv">1</span>, datax<span class="sc">$</span>maxage, <span class="at">length=</span><span class="dv">100</span>))</span>
<span id="cb330-6"><a href="dailynestsurv.html#cb330-6" tabindex="-1"></a>newdat<span class="sc">$</span>age.z <span class="ot">&lt;-</span> (newdat<span class="sc">$</span>age<span class="sc">-</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span>datax<span class="sc">$</span>maxage))<span class="sc">/</span><span class="fu">sd</span>((<span class="dv">1</span><span class="sc">:</span>datax<span class="sc">$</span>maxage))</span>
<span id="cb330-7"><a href="dailynestsurv.html#cb330-7" tabindex="-1"></a>Xmat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>age.z, <span class="at">data=</span>newdat)</span>
<span id="cb330-8"><a href="dailynestsurv.html#cb330-8" tabindex="-1"></a>fitmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol=</span>nsim, <span class="at">nrow=</span><span class="fu">nrow</span>(newdat))</span>
<span id="cb330-9"><a href="dailynestsurv.html#cb330-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) fitmat[,i] <span class="ot">&lt;-</span> <span class="fu">plogis</span>(Xmat<span class="sc">%*%</span><span class="fu">as.numeric</span>(bsim[i,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]))</span>
<span id="cb330-10"><a href="dailynestsurv.html#cb330-10" tabindex="-1"></a>newdat<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmat, <span class="dv">1</span>, median)</span>
<span id="cb330-11"><a href="dailynestsurv.html#cb330-11" tabindex="-1"></a>newdat<span class="sc">$</span>lwr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmat, <span class="dv">1</span>, quantile, <span class="at">prob=</span><span class="fl">0.025</span>)</span>
<span id="cb330-12"><a href="dailynestsurv.html#cb330-12" tabindex="-1"></a>newdat<span class="sc">$</span>upr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmat, <span class="dv">1</span>, quantile, <span class="at">prob=</span><span class="fl">0.975</span>)</span>
<span id="cb330-13"><a href="dailynestsurv.html#cb330-13" tabindex="-1"></a></span>
<span id="cb330-14"><a href="dailynestsurv.html#cb330-14" tabindex="-1"></a><span class="fu">plot</span>(newdat<span class="sc">$</span>age, newdat<span class="sc">$</span>fit, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb330-15"><a href="dailynestsurv.html#cb330-15" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&quot;Daily nest survival&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Age [d]&quot;</span>)</span>
<span id="cb330-16"><a href="dailynestsurv.html#cb330-16" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>age, newdat<span class="sc">$</span>lwr, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb330-17"><a href="dailynestsurv.html#cb330-17" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>age, newdat<span class="sc">$</span>upr, <span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:effplots"></span>
<img src="3.2_daily_nest_survival_files/figure-html/effplots-1.png" alt="Estimated daily nest survival probability in relation to nest age. Dotted lines are 95% uncertainty intervals of the regression line." width="672" />
<p class="caption">
Figure 24.1: Estimated daily nest survival probability in relation to nest age. Dotted lines are 95% uncertainty intervals of the regression line.
</p>
</div>
</div>
<div id="known-fate-model-for-irregular-nest-controls" class="section level2 hasAnchor" number="24.8">
<h2><span class="header-section-number">24.8</span> Known fate model for irregular nest controls<a href="dailynestsurv.html#known-fate-model-for-irregular-nest-controls" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When nest are controlled only irregularly, it may happen that a nest is found predated or dead after a longer break in controlling. In such cases, we know that the nest was predated or it died due to other causes some when between the last control when the nest was still alive and when it was found dead. In such cases, we need to tell the model that the nest could have died any time during the interval when we were not controlling.</p>
<p>To do so, we create a variable that indicates the time (e.g. day since first egg) when the nest was last seen alive (<code>lastlive</code>). A second variable indicates the time of the last check which is either the equal to <code>lastlive</code> when the nest survived until the last check, or it is larger than <code>lastlive</code> when the nest failure has been recorded. A last variable, <code>gap</code>, measures the time interval in which the nest failure occurred. A <code>gap</code> of zero means that the nest was still alive at the last control, a <code>gap</code>of 1 means that the nest failure occurred during the first day after <code>lastlive</code>, a <code>gap</code> of 2 means that the nest failure either occurred at the first or second day after <code>lastlive</code>.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="dailynestsurv.html#cb331-1" tabindex="-1"></a><span class="co"># time when nest was last observed alive</span></span>
<span id="cb331-2"><a href="dailynestsurv.html#cb331-2" tabindex="-1"></a>lastlive <span class="ot">&lt;-</span> <span class="fu">apply</span>(datax<span class="sc">$</span>y, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x))[x<span class="sc">==</span><span class="dv">1</span>]))</span>
<span id="cb331-3"><a href="dailynestsurv.html#cb331-3" tabindex="-1"></a></span>
<span id="cb331-4"><a href="dailynestsurv.html#cb331-4" tabindex="-1"></a><span class="co"># time when nest was last checked (alive or dead)</span></span>
<span id="cb331-5"><a href="dailynestsurv.html#cb331-5" tabindex="-1"></a>lastcheck <span class="ot">&lt;-</span> lastlive<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb331-6"><a href="dailynestsurv.html#cb331-6" tabindex="-1"></a><span class="co"># here, we turn the above data into a format that can be used for</span></span>
<span id="cb331-7"><a href="dailynestsurv.html#cb331-7" tabindex="-1"></a><span class="co"># irregular nest controls. WOULD BE NICE TO HAVE A REAL DATA EXAMPLE!</span></span>
<span id="cb331-8"><a href="dailynestsurv.html#cb331-8" tabindex="-1"></a></span>
<span id="cb331-9"><a href="dailynestsurv.html#cb331-9" tabindex="-1"></a><span class="co"># when nest was observed alive at the last check, then lastcheck equals lastlive</span></span>
<span id="cb331-10"><a href="dailynestsurv.html#cb331-10" tabindex="-1"></a>lastcheck[lastlive<span class="sc">==</span>datax<span class="sc">$</span>last] <span class="ot">&lt;-</span> datax<span class="sc">$</span>last[lastlive<span class="sc">==</span>datax<span class="sc">$</span>last]</span>
<span id="cb331-11"><a href="dailynestsurv.html#cb331-11" tabindex="-1"></a></span>
<span id="cb331-12"><a href="dailynestsurv.html#cb331-12" tabindex="-1"></a>datax1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Nnests=</span>datax<span class="sc">$</span>Nnests,</span>
<span id="cb331-13"><a href="dailynestsurv.html#cb331-13" tabindex="-1"></a>               <span class="at">lastlive =</span> lastlive,</span>
<span id="cb331-14"><a href="dailynestsurv.html#cb331-14" tabindex="-1"></a>               <span class="at">lastcheck=</span> lastcheck,</span>
<span id="cb331-15"><a href="dailynestsurv.html#cb331-15" tabindex="-1"></a>               <span class="at">first=</span>datax<span class="sc">$</span>first,</span>
<span id="cb331-16"><a href="dailynestsurv.html#cb331-16" tabindex="-1"></a>               <span class="at">cover=</span>datax<span class="sc">$</span>cover,</span>
<span id="cb331-17"><a href="dailynestsurv.html#cb331-17" tabindex="-1"></a>               <span class="at">age=</span>datax<span class="sc">$</span>age,</span>
<span id="cb331-18"><a href="dailynestsurv.html#cb331-18" tabindex="-1"></a>               <span class="at">maxage=</span>datax<span class="sc">$</span>maxage)</span>
<span id="cb331-19"><a href="dailynestsurv.html#cb331-19" tabindex="-1"></a><span class="co"># time between last seen alive and first seen dead (= lastcheck)</span></span>
<span id="cb331-20"><a href="dailynestsurv.html#cb331-20" tabindex="-1"></a>datax1<span class="sc">$</span>gap <span class="ot">&lt;-</span> datax1<span class="sc">$</span>lastcheck<span class="sc">-</span>datax1<span class="sc">$</span>lastlive</span></code></pre></div>
<p>In the Stan model code, we specify the likelihood for each gap separately.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb332-1"><a href="dailynestsurv.html#cb332-1" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb332-2"><a href="dailynestsurv.html#cb332-2" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; Nnests;                <span class="co">// number of nests</span></span>
<span id="cb332-3"><a href="dailynestsurv.html#cb332-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; lastlive[Nnests];      <span class="co">// day of last observation (alive)</span></span>
<span id="cb332-4"><a href="dailynestsurv.html#cb332-4" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; lastcheck[Nnests];       <span class="co">// day of observed death or, if alive, last day of study </span></span>
<span id="cb332-5"><a href="dailynestsurv.html#cb332-5" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; first[Nnests];         <span class="co">// day of first observation (alive or dead)</span></span>
<span id="cb332-6"><a href="dailynestsurv.html#cb332-6" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; maxage;                <span class="co">// maximum of last</span></span>
<span id="cb332-7"><a href="dailynestsurv.html#cb332-7" tabindex="-1"></a>  <span class="dt">real</span> cover[Nnests];                 <span class="co">// a covariate of the nest</span></span>
<span id="cb332-8"><a href="dailynestsurv.html#cb332-8" tabindex="-1"></a>  <span class="dt">real</span> age[maxage];                   <span class="co">// a covariate of the date</span></span>
<span id="cb332-9"><a href="dailynestsurv.html#cb332-9" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; gap[Nnests];           <span class="co">// obsdead - lastlive</span></span>
<span id="cb332-10"><a href="dailynestsurv.html#cb332-10" tabindex="-1"></a>}</span>
<span id="cb332-11"><a href="dailynestsurv.html#cb332-11" tabindex="-1"></a></span>
<span id="cb332-12"><a href="dailynestsurv.html#cb332-12" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb332-13"><a href="dailynestsurv.html#cb332-13" tabindex="-1"></a>  <span class="dt">vector</span>[<span class="dv">3</span>] b;                          <span class="co">// coef of linear pred for S</span></span>
<span id="cb332-14"><a href="dailynestsurv.html#cb332-14" tabindex="-1"></a>}</span>
<span id="cb332-15"><a href="dailynestsurv.html#cb332-15" tabindex="-1"></a></span>
<span id="cb332-16"><a href="dailynestsurv.html#cb332-16" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb332-17"><a href="dailynestsurv.html#cb332-17" tabindex="-1"></a>  <span class="dt">real</span> S[Nnests, maxage<span class="dv">-1</span>];             <span class="co">// survival probability</span></span>
<span id="cb332-18"><a href="dailynestsurv.html#cb332-18" tabindex="-1"></a>                </span>
<span id="cb332-19"><a href="dailynestsurv.html#cb332-19" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span>:Nnests){  </span>
<span id="cb332-20"><a href="dailynestsurv.html#cb332-20" tabindex="-1"></a>    <span class="cf">for</span>(t <span class="cf">in</span> first[i]:(lastcheck[i]-<span class="dv">1</span>)){ </span>
<span id="cb332-21"><a href="dailynestsurv.html#cb332-21" tabindex="-1"></a>      S[i,t] = inv_logit(b[<span class="dv">1</span>] + b[<span class="dv">2</span>]*cover[i] + b[<span class="dv">3</span>]*age[t]); </span>
<span id="cb332-22"><a href="dailynestsurv.html#cb332-22" tabindex="-1"></a>    }</span>
<span id="cb332-23"><a href="dailynestsurv.html#cb332-23" tabindex="-1"></a>  }</span>
<span id="cb332-24"><a href="dailynestsurv.html#cb332-24" tabindex="-1"></a></span>
<span id="cb332-25"><a href="dailynestsurv.html#cb332-25" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb332-26"><a href="dailynestsurv.html#cb332-26" tabindex="-1"></a>  b[<span class="dv">1</span>]~normal(<span class="dv">0</span>,<span class="fl">1.5</span>);</span>
<span id="cb332-27"><a href="dailynestsurv.html#cb332-27" tabindex="-1"></a>  b[<span class="dv">2</span>]~normal(<span class="dv">0</span>,<span class="dv">3</span>);</span>
<span id="cb332-28"><a href="dailynestsurv.html#cb332-28" tabindex="-1"></a>  b[<span class="dv">3</span>]~normal(<span class="dv">0</span>,<span class="dv">3</span>);  </span>
<span id="cb332-29"><a href="dailynestsurv.html#cb332-29" tabindex="-1"></a></span>
<span id="cb332-30"><a href="dailynestsurv.html#cb332-30" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb332-31"><a href="dailynestsurv.html#cb332-31" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:Nnests) {</span>
<span id="cb332-32"><a href="dailynestsurv.html#cb332-32" tabindex="-1"></a>    <span class="cf">for</span>(t <span class="cf">in</span> (first[i]+<span class="dv">1</span>):lastlive[i]){</span>
<span id="cb332-33"><a href="dailynestsurv.html#cb332-33" tabindex="-1"></a>      <span class="dv">1</span>~bernoulli(S[i,t<span class="dv">-1</span>]);</span>
<span id="cb332-34"><a href="dailynestsurv.html#cb332-34" tabindex="-1"></a>    }</span>
<span id="cb332-35"><a href="dailynestsurv.html#cb332-35" tabindex="-1"></a>    <span class="cf">if</span>(gap[i]==<span class="dv">1</span>){</span>
<span id="cb332-36"><a href="dailynestsurv.html#cb332-36" tabindex="-1"></a>      <span class="kw">target +=</span> log(<span class="dv">1</span>-S[i,lastlive[i]]);  <span class="co">// </span></span>
<span id="cb332-37"><a href="dailynestsurv.html#cb332-37" tabindex="-1"></a>    }</span>
<span id="cb332-38"><a href="dailynestsurv.html#cb332-38" tabindex="-1"></a>    <span class="cf">if</span>(gap[i]==<span class="dv">2</span>){</span>
<span id="cb332-39"><a href="dailynestsurv.html#cb332-39" tabindex="-1"></a>      <span class="kw">target +=</span> log((<span class="dv">1</span>-S[i,lastlive[i]]) + S[i,lastlive[i]]*(<span class="dv">1</span>-S[i,lastlive[i]+<span class="dv">1</span>]));  <span class="co">// </span></span>
<span id="cb332-40"><a href="dailynestsurv.html#cb332-40" tabindex="-1"></a>    }</span>
<span id="cb332-41"><a href="dailynestsurv.html#cb332-41" tabindex="-1"></a>    <span class="cf">if</span>(gap[i]==<span class="dv">3</span>){</span>
<span id="cb332-42"><a href="dailynestsurv.html#cb332-42" tabindex="-1"></a>      <span class="kw">target +=</span> log((<span class="dv">1</span>-S[i,lastlive[i]]) + S[i,lastlive[i]]*(<span class="dv">1</span>-S[i,lastlive[i]+<span class="dv">1</span>]) +</span>
<span id="cb332-43"><a href="dailynestsurv.html#cb332-43" tabindex="-1"></a>                    prod(S[i,lastlive[i]:(lastlive[i]+<span class="dv">1</span>)])*(<span class="dv">1</span>-S[i,lastlive[i]+<span class="dv">2</span>]));  <span class="co">// </span></span>
<span id="cb332-44"><a href="dailynestsurv.html#cb332-44" tabindex="-1"></a>    }</span>
<span id="cb332-45"><a href="dailynestsurv.html#cb332-45" tabindex="-1"></a>    <span class="cf">if</span>(gap[i]==<span class="dv">4</span>){</span>
<span id="cb332-46"><a href="dailynestsurv.html#cb332-46" tabindex="-1"></a>      <span class="kw">target +=</span> log((<span class="dv">1</span>-S[i,lastlive[i]]) + S[i,lastlive[i]]*(<span class="dv">1</span>-S[i,lastlive[i]+<span class="dv">1</span>]) +</span>
<span id="cb332-47"><a href="dailynestsurv.html#cb332-47" tabindex="-1"></a>                    prod(S[i,lastlive[i]:(lastlive[i]+<span class="dv">1</span>)])*(<span class="dv">1</span>-S[i,lastlive[i]+<span class="dv">2</span>]) +</span>
<span id="cb332-48"><a href="dailynestsurv.html#cb332-48" tabindex="-1"></a>                    prod(S[i,lastlive[i]:(lastlive[i]+<span class="dv">2</span>)])*(<span class="dv">1</span>-S[i,lastlive[i]+<span class="dv">3</span>]));  <span class="co">// </span></span>
<span id="cb332-49"><a href="dailynestsurv.html#cb332-49" tabindex="-1"></a>    }</span>
<span id="cb332-50"><a href="dailynestsurv.html#cb332-50" tabindex="-1"></a></span>
<span id="cb332-51"><a href="dailynestsurv.html#cb332-51" tabindex="-1"></a>  }</span>
<span id="cb332-52"><a href="dailynestsurv.html#cb332-52" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="dailynestsurv.html#cb333-1" tabindex="-1"></a><span class="co"># Run STAN</span></span>
<span id="cb333-2"><a href="dailynestsurv.html#cb333-2" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">file =</span> <span class="st">&quot;stanmodels/daily_nest_survival_irreg.stan&quot;</span>, <span class="at">data=</span>datax1, </span>
<span id="cb333-3"><a href="dailynestsurv.html#cb333-3" tabindex="-1"></a>            <span class="at">chains=</span><span class="dv">5</span>, <span class="at">iter=</span><span class="dv">2500</span>, <span class="at">control=</span><span class="fu">list</span>(<span class="at">adapt_delta=</span><span class="fl">0.9</span>), <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="further-reading-8" class="section level2 unnumbered hasAnchor">
<h2>Further reading<a href="dailynestsurv.html#further-reading-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Helpful links:</p>
<p><a href="https://deepai.org/publication/bayesian-survival-analysis-using-the-rstanarm-r-package" class="uri">https://deepai.org/publication/bayesian-survival-analysis-using-the-rstanarm-r-package</a> <span class="citation">(<a href="referenzen.html#ref-Brilleman.2020">Brilleman et al. 2020</a>)</span></p>
<p><a href="https://www.hammerlab.org/2017/06/26/introducing-survivalstan/" class="uri">https://www.hammerlab.org/2017/06/26/introducing-survivalstan/</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="zeroinflated-poisson-lmm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cjs_with_mix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TobiasRoth/BDAEcology/edit/master/3.2_daily_nest_survival.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
